<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Simulado DP-600 — Léo Vianna</title>
<style>
:root{
  --bg:#f3f6f9; --card:#ffffff; --primary:#0078d4; --accent:#28a745; --muted:#6b7280;
  --radius:12px; --shadow:0 6px 20px rgba(16,24,40,0.06);
  font-family: Inter, 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:#0f172a}
.wrap{max-width:980px;margin:28px auto;padding:20px}
header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
header h1{font-size:1.25rem;margin:0;color:var(--primary)}
.card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:20px}
.progress{font-size:0.95rem;color:var(--muted);margin-bottom:12px}
.question-text{font-size:1.05rem;margin-bottom:12px;line-height:1.45}
.options{list-style:none;padding:0;margin:0}
.option{background:#fafafa;border:1px solid #e6eef8;padding:12px;border-radius:10px;margin-bottom:10px;cursor:pointer;transition:all .15s}
.option:hover{transform:translateY(-2px)}
.option.selected{border-color:var(--primary);background:#eef9ff}
.option.correct{background:#d4edda;border-color:#28a745;color:#155724}
.option.wrong{background:#f8d7da;border-color:#dc3545;color:#721c24}
.controls{display:flex;gap:10px;justify-content:space-between;margin-top:16px}
button{padding:10px 16px;border-radius:8px;border:0;cursor:pointer;font-size:1rem}
.btn-primary{background:var(--primary);color:white}
.btn-ghost{background:transparent;border:1px solid #ddd}
.summary{margin-top:18px;padding:12px;border-radius:8px;background:#fff7ed;border:1px solid #ffefd5;color:#663c00}
.final-card{text-align:center;padding:20px}
.err-list{text-align:left;margin-top:12px}
.small{font-size:0.9rem;color:var(--muted)}
.warn{color:#b45309;background:#fffbeb;padding:10px;border-radius:8px;margin-top:10px;border:1px solid #fcd34d}
@media(max-width:640px){.wrap{padding:12px}}
</style>
</head>
<body>
<div class="wrap card">
  <header>
    <div>
      <h1>Simulado DP-600 — Léo Vianna</h1>
      <div class="small">Use "Verificar Resposta" para mostrar a resposta correta.</div>
    </div>
  </header>

  <div id="quiz" >
    <div class="progress" id="progress">Questão 1 de ?</div>
    <div id="question-area"></div>
    <div class="controls">
      <button id="btn-prev" class="btn-ghost">Anterior</button>
      <div style="flex:1"></div>
      <button id="btn-check" class="btn-primary">Verificar Resposta</button>
      <button id="btn-next" class="btn-primary" style="display:none;margin-left:8px">Próxima</button>
    </div>
    <div id="result-box" class="summary" style="display:none"></div>
    <div id="error-msg" class="warn" style="display:none"></div>
  </div>
</div>

<script>
// ===== QUIZ DATA (65 questões corrigidas) =====
const quizData = [
  {"q":"Você tem um tenant (locatário) do Fabric que contém um modelo de machine learning registrado em um workspace do Fabric. Você precisa usar o modelo para gerar previsões usando a função PREDICT em um notebook do Fabric. Quais duas linguagens você pode usar para realizar a pontuação (scoring) do modelo? Cada resposta correta apresenta uma solução completa. NOTA: Cada resposta correta vale um ponto.","options":["A. T-SQL","B. DAX","C. Spark SQL ","D. PySpark "],"answer":[2,3]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um warehouse. Você usa um dataflow (fluxo de dados) para carregar um novo conjunto de dados do OneLake para o warehouse. Você precisa adicionar uma etapa do Power Query para identificar os valores máximos das colunas numéricas. Qual função você deve incluir na etapa?","options":["A. Table.MaxN","B. Table.Max","C. Table.Range","D. Table.Profile "],"answer":[3]},
  {"q":"Você é o administrador de um workspace (área de trabalho) do Fabric que contém um lakehouse chamado Lakehouse1. O Lakehouse1 contém as seguintes tabelas: Tabela1: Uma tabela Delta criada usando um atalho (shortcut) Tabela2: Uma tabela externa criada usando Spark Tabela3: Uma tabela gerenciada (managed table) Você planeja se conectar ao Lakehouse1 usando seu SQL endpoint (ponto de extremidade SQL). O que você será capaz de fazer após se conectar ao Lakehouse1?","options":["A. Ler a Tabela3. ","B. Atualizar os dados na Tabela3.","C. Ler a Tabela2.","D. Atualizar os dados na Tabela1."],"answer":[0]},
  {"q":"Você está analisando dados em um notebook do Fabric. Você tem um Spark DataFrame atribuído a uma variável chamada df. Você precisa usar a visualização de Gráfico (Chart view) no notebook para explorar os dados manualmente. Qual função você deve executar para disponibilizar os dados na visualização de Gráfico?","options":["A. displayHTML","B. show","C. write","D. display "],"answer":[3]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um relatório do Microsoft Power BI chamado Report1. O Report1 inclui um visual Python. Os dados exibidos pelo visual são agrupados automaticamente e as linhas duplicadas NÃO são exibidas. Você precisa que todas as linhas apareçam no visual. O que você deve fazer?","options":["A. Referenciar as colunas no código Python pelo índice.","B. Modificar a propriedade \"Classificar Coluna por\" (Sort Column By) para todas as colunas.","C. Adicionar um campo único a cada linha. ","D. Modificar a propriedade \"Resumir Por\" (Summarize By) para todas as colunas."],"answer":[2]},
  {"q":"Você tem um tenant (locatário) do Fabric chamado Tenant1 que contém um workspace (área de trabalho) chamado WS1. O WS1 usa uma capacidade (capacity) chamada C1 e contém um conjunto de dados (dataset) chamado DS1. Você precisa garantir que o acesso de leitura e escrita (read-write) ao DS1 esteja disponível usando o endpoint XMLA. O que deve ser modificado primeiro?","options":["A. as configurações do DS1","B. as configurações do WS1","C. as configurações do C1 ","D. as configurações do Tenant1"],"answer":[2]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um workspace (área de trabalho) chamado Workspace1. O Workspace1 está atribuído a uma capacidade (capacity) do Fabric. Você precisa recomendar uma solução para dar aos usuários a capacidade de criar e publicar modelos semânticos Direct Lake personalizados usando ferramentas externas. A solução deve seguir o princípio do menor privilégio. Quais três ações no portal de administração do Fabric você deve incluir na recomendação? Cada resposta correta apresenta parte da solução. NOTA: Cada resposta correta vale um ponto.","options":["A. Nas configurações do Tenant, definir \"Permitir Endpoints XMLA e Analisar no Excel com conjuntos de dados locais\" como Habilitado. ","B. Nas configurações do Tenant, definir \"Permitir que usuários convidados do Azure Active Directory acessem o Microsoft Fabric\" como Habilitado.","C. Nas configurações do Tenant, selecionar \"Usuários podem editar o modelo de dados no serviço do Power BI\".","D. Nas configurações da Capacidade, definir \"Endpoint XMLA\" como Leitura e Escrita (Read Write). ","E. Nas configurações do Tenant, definir \"Usuários podem criar itens do Fabric\" como Habilitado. ","F. Nas configurações do Tenant, habilitar \"Publicar na Web\"."],"answer":[0,3,4]},
  {"q":"Você está criando um modelo semântico no Microsoft Power BI Desktop. Você planeja fazer alterações em massa no modelo usando a extensão Tabular Model Definition Language (TMDL) para o Microsoft Visual Studio Code. Você precisa salvar o modelo semântico em um arquivo. Qual formato de arquivo você deve usar?","options":["A. PBIP ","B. PBIX","C. PBIT","D. PBIDS"],"answer":[0]},
  {"q":"Você planeja implantar itens do Microsoft Power BI usando pipelines de implantação (deployment pipelines) do Fabric. Você tem um pipeline de implantação que contém três estágios chamados Desenvolvimento (Development), Teste (Test) e Produção (Production). Um workspace (área de trabalho) está atribuído a cada estágio. Você precisa fornecer aos desenvolvedores do Power BI acesso ao pipeline. A solução deve atender aos seguintes requisitos: Garantir que os desenvolvedores possam implantar itens nos workspaces de Desenvolvimento e Teste. Impedir que os desenvolvedores implantem itens no workspace de Produção. Seguir o princípio do menor privilégio. Quais três níveis de acesso você deve atribuir aos desenvolvedores? Cada resposta correta apresenta parte da solução. NOTA: Cada resposta correta vale um ponto.","options":["A. Permissão de \"Compilação\" (Build) para os modelos semânticos de produção.","B. Acesso de \"Administrador\" (Admin) ao pipeline de implantação. ","C. Acesso de \"Visualizador\" (Viewer) aos workspaces de Desenvolvimento e Teste.","D. Acesso de \"Visualizador\" (Viewer) ao workspace de Produção. ","E. Acesso de \"Contribuidor\" (Contributor) aos workspaces de Desenvolvimento e Teste. ","F. Acesso de \"Contribuidor\" (Contributor) ao workspace de Produção."],"answer":[1,3,4]},
  {"q":"Você tem um workspace (área de trabalho) do Fabric que contém um modelo semântico DirectQuery. O modelo consulta uma fonte de dados que possui 500 milhões de linhas. Você tem um relatório do Microsoft Power BI chamado Report1 que usa o modelo. O Report1 contém visuais em várias páginas. Você precisa reduzir o tempo de execução da consulta para os visuais em todas as páginas. Quais dois recursos você pode usar? Cada resposta correta apresenta uma solução completa. NOTA: Cada resposta correta vale um ponto.","options":["A. Agregações definidas pelo usuário (user-defined aggregations) ","B. Agregação automática (automatic aggregation) ","C. Cache de consulta (query caching)","D. Integração com o OneLake (OneLake integration)"],"answer":[0,1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém 30 arquivos CSV no OneLake. Os arquivos são atualizados diariamente. Você cria um modelo semântico do Microsoft Power BI chamado Model1 que usa os arquivos CSV como fonte de dados. Você configura a atualização incremental (incremental refresh) para o Model1 e publica o modelo em uma capacidade Premium no tenant do Fabric. Ao iniciar uma atualização do Model1, a atualização falha por falta de recursos (running out of resources). Qual é uma causa provável da falha?","options":["A. O Query folding (dobragem de consulta) está ocorrendo.","B. A opção \"Atualizar apenas dias completos\" (Only refresh complete days) está selecionada.","C. O Endpoint XMLA está definido como Somente Leitura (Read Only).","D. O Query folding (dobragem de consulta) NÃO está ocorrendo.","E. O tipo de dado da coluna usada para particionar os dados foi alterado. "],"answer":[4]},
  {"q":"Você tem um tenant (locatário) do Fabric que usa uma capacidade Microsoft Power BI Premium. Você precisa habilitar o scale-out (expansão) para um modelo semântico. O que você deve fazer primeiro?","options":["A. No nível do modelo semântico, definir o \"Formato de armazenamento de conjunto de dados grande\" (Large dataset storage format) como Desligado (Off).","B. No nível do tenant, definir \"Criar e usar Métricas\" (Create and use Metrics) como Habilitado (Enabled).","C. No nível do modelo semântico, definir o \"Formato de armazenamento de conjunto de dados grande\" (Large dataset storage format) como Ligado (On). ","D. No nível do tenant, definir o \"Ativador de Dados\" (Data Activator) como Habilitado (Enabled)."],"answer":[2]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um warehouse. O warehouse usa segurança em nível de linha (RLS). Você cria um modelo semântico Direct Lake que usa as tabelas Delta e a RLS do warehouse. Quando os usuários interagem com um relatório criado a partir do modelo, qual modo será usado pelas consultas DAX?","options":["A. DirectQuery ","B. Dual","C. Direct Lake","D. Import"],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um modelo semântico complexo. O modelo é baseado em um esquema estrela (star schema) e contém muitas tabelas, incluindo uma tabela fato chamada Sales. Você precisa criar um diagrama do modelo. O diagrama deve conter apenas a tabela Sales e as tabelas relacionadas a ela. O que você deve usar no Microsoft Power BI Desktop?","options":["A. Categorias de dados (Data categories)","B. Modo de exibição de dados (Data view)","C. Modo de exibição de modelo (Model view) ","D. Modo de exibição de consulta DAX (DAX query view)"],"answer":[2]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um modelo semântico. O modelo usa o modo Direct Lake. Você suspeita que algumas consultas DAX carregam colunas desnecessárias na memória (cache). Você precisa identificar as colunas usadas com frequência que são carregadas na memória. Quais são as duas maneiras de atingir esse objetivo? Cada resposta correta apresenta uma solução completa. NOTA: Cada resposta correta vale um ponto.","options":["A. Usar o recurso \"Analisar no Excel\" (Analyze in Excel).","B. Usar a ferramenta Vertipaq Analyzer. ","C. Consultar a exibição de gerenciamento dinâmico (DMV) $System.DISCOVER_STORAGE_TABLE_COLUMN_SEGMENTS. ","D. Consultar a exibição de gerenciamento dinâmico (DMV) DISCOVER_MEMORYGRANT."],"answer":[1,2]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um modelo semântico chamado Model1. O Model1 usa o modo Importação (Import mode). O Model1 contém uma tabela chamada Orders. A tabela Orders tem 100 milhões de linhas e os seguintes campos: OrderID (Integer), OrderDateTime (Date/Time), Quantity (Integer), Price (Decimal), TotalSalesAmount (Decimal - coluna calculada), TotalQuantity (Integer - medida). Você precisa reduzir a memória usada pelo Model1 e o tempo que leva para atualizar o modelo. Quais duas ações você deve realizar?","options":["A. Dividir OrderDateTime em colunas separadas de data e hora. ","B. Substituir TotalQuantity por uma coluna calculada.","C. Converter Quantity para o tipo de dado Texto.","D. Substituir TotalSalesAmount por uma medida. "],"answer":[0,3]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um modelo semântico. Você precisa impedir que os criadores de relatórios preencham visuais usando medidas implícitas (implicit measures). Quais são as duas ferramentas que você pode usar para atingir esse objetivo? Cada resposta correta apresenta uma solução completa.","options":["A. Microsoft Power BI Desktop ","B. Tabular Editor ","C. Microsoft SQL Server Management Studio (SSMS)","D. DAX Studio"],"answer":[0,1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado Lakehouse1. O Lakehouse1 contém uma tabela chamada Table1. Você está criando um novo pipeline de dados. Você planeja copiar dados externos para a Table1. O esquema (schema) dos dados externos muda regularmente. Você precisa que a operação de cópia atenda aos seguintes requisitos: Substituir o esquema da Table1 pelo esquema dos dados externos. Substituir todos os dados na Table1 pelas linhas dos dados externos. Você adiciona uma atividade de \"Copy data\" (Copiar dados) ao pipeline. O que você deve fazer na atividade \"Copy data\"?","options":["A. Na guia \"Origem\" (Source), adicionar colunas adicionais.","B. Na guia \"Destino\" (Destination), definir a \"Ação da tabela\" (Table action) como \"Overwrite\" (Substituir). ","C. Na guia \"Configurações\" (Settings), selecionar \"Habilitar preparo\" (Enable staging).","D. Na guia \"Origem\" (Source), selecionar \"Habilitar descoberta de partição\" (Enable partition discovery).","E. Na guia \"Origem\" (Source), selecionar \"Recursivamente\" (Recursively)."],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse. Você planeja consultar arquivos de dados de vendas usando o SQL endpoint (ponto de extremidade SQL). Os arquivos estarão em um bucket de armazenamento Amazon S3. Você precisa recomendar qual formato de arquivo usar e onde criar um atalho (shortcut). Quais duas ações você deve incluir na recomendação? Cada resposta correta apresenta parte da solução.","options":["A. Criar um atalho na seção \"Arquivos\" (Files).","B. Usar o formato Parquet.","C. Usar o formato CSV.","D. Criar um atalho na seção \"Tabelas\" (Tables). ","E. Usar o formato delta. "],"answer":[3,4]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado Lakehouse1. O Lakehouse1 contém uma subpasta chamada Subfolder1 que contém arquivos CSV. Você precisa converter os arquivos CSV para o formato delta e garantir que a otimização V-Order (V-Order optimization) esteja habilitada. O que você deve fazer a partir do explorador (explorer) do Lakehouse?","options":["A. Usar o recurso \"Carregar em Tabelas\" (Load to Tables). ","B. Criar um novo atalho na seção \"Arquivos\" (Files).","C. Criar um novo atalho na seção \"Tabelas\" (Tables).","D. Usar o recurso \"Otimizar\" (Optimize)."],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado Lakehouse1. O Lakehouse1 contém uma tabela não particionada (unpartitioned) chamada Table1. Você planeja copiar dados para a Table1 e particionar a tabela com base em uma coluna de data dos dados de origem. Você cria uma atividade \"Copy\" (Copiar) para copiar os dados para a Table1. Você precisa especificar a coluna de partição nas configurações de \"Destino\" (Destination) da atividade \"Copy\". O que você deve fazer primeiro?","options":["A. Na guia \"Destino\", definir o \"Modo\" (Mode) como \"Append\" (Anexar).","B. Na guia \"Destino\", selecionar a coluna de partição.","C. Na guia \"Origem\" (Source), selecionar \"Habilitar descoberta de partição\" (Enable partition discovery).","D. Na guia \"Destino\", definir o \"Modo\" (Mode) como \"Overwrite\" (Substituir). "],"answer":[3]},
  {"q":"Você tem dados de origem em uma pasta em um computador local. Você precisa criar uma solução que usará o Fabric para popular um armazenamento de dados (data store). A solução deve atender aos seguintes requisitos: Suportar o uso de dataflows (fluxos de dados) para carregar e anexar (append) dados ao data store. Garantir que as tabelas Delta sejam otimizadas com V-Order e compactadas automaticamente. Pergunta: Quais dois tipos de data store você deve usar?","options":["A. um lakehouse ","B. um banco de dados SQL do Azure","C. um warehouse ","D. um banco de dados KQL"],"answer":[0,2]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um pipeline de dados. Você precisa garantir que o pipeline seja executado a cada quatro horas às segundas-feiras e sextas-feiras. Para o que você deve definir a opção \"Repetir\" (Repeat) no agendamento?","options":["A. Diariamente (Daily)","B. Por minuto (By the minute)","C. Semanalmente (Weekly) ","D. Por hora (Hourly)"],"answer":[2]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um warehouse. Várias vezes ao dia, o desempenho de todas as consultas do warehouse se degrada. Você suspeita que o Fabric está aplicando throttling (limitação) à computação usada pelo warehouse. O que você deve usar para identificar se o throttling está ocorrendo?","options":["A. As configurações de Capacidade (Capacity settings)","B. O Hub de Monitoramento (Monitoring hub)","C. As exibições de gerenciamento dinâmico (DMVs)","D. O aplicativo de Métricas de Capacidade do Microsoft Fabric (the Microsoft Fabric Capacity Metrics app) "],"answer":[3]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um warehouse. Um usuário descobre que um relatório que geralmente leva dois minutos para renderizar está sendo executado há 45 minutos e ainda não foi renderizado. Você precisa identificar o que está impedindo a consulta do relatório de ser concluída. Qual exibição de gerenciamento dinâmico (DMV) você deve usar?","options":["A. sys.dm_exec_requests ","B. sys.dm_exec_sessions","C. sys.dm_exec_connections","D. sys.dm_pdw_exec_requests"],"answer":[0]},
  {"q":"Você precisa criar um padrão de carregamento de dados para uma dimensão de alteração lenta (SCD) Tipo 1. Quais duas ações você deve incluir no processo?","options":["A. Atualizar linhas quando os atributos não-chave (non-key attributes) mudaram. ","B. Inserir novas linhas quando a chave natural existe na tabela de dimensão, e os valores dos atributos não-chave mudaram.","C. Atualizar a data de fim de vigência (effective end date) das linhas quando os atributos não-chave mudaram.","D. Inserir novos registros quando a chave natural é um novo valor na tabela. "],"answer":[0,3]},
  {"q":"Você está analisando compras de clientes em um notebook do Fabric usando PySpark. Você tem os seguintes DataFrames: transactions (10 milhões de linhas) e customers (1.000 linhas). Você precisa fazer um join minimizando shuffling. Qual código você deve executar?","options":["A. transactions.join(F.broadcast(customers), transactions.customer_id == customers.customer_id) ","B. transactions.join(customers, transactions.customer_id == customers.customer_id).distinct()","C. transactions.join(customers, transactions.customer_id == customers.customer_id)","D. transactions.crossJoin(customers).where(transactions.customer_id == customers.customer_id)"],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um novo modelo semântico no OneLake. Você usa um notebook do Fabric para ler os dados em um Spark DataFrame. Você precisa avaliar os dados para calcular os valores mínimo (min), máximo (max), média (mean) e desvio padrão (standard deviation) para todas as colunas de string e numéricas. Solução: Você usa a seguinte expressão PySpark: df.exlpain() Isso atende ao objetivo?","options":["A. Sim","B. Não "],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um novo modelo semântico no OneLake. Você usa um notebook do Fabric para ler os dados em um Spark DataFrame. Você precisa avaliar os dados para calcular os valores mínimo (min), máximo (max), média (mean) e desvio padrão (standard deviation) para todas as colunas de string e numéricas. Solução: Você usa a seguinte expressão PySpark: df.show() atende?","options":["A. Sim","B. Não "],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um novo modelo semântico no OneLake. Você usa um notebook do Fabric para ler os dados em um Spark DataFrame. Você precisa avaliar os dados para calcular os valores mínimo (min), máximo (max), média (mean) e desvio padrão (standard deviation) para todas as colunas de string e numéricas. Solução: Você usa a seguinte expressão PySpark: df.summary() atende?","options":["A. Sim ","B. Não"],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado Lakehouse1. O Lakehouse1 contém uma tabela Delta chamada Customer. Ao consultar a tabela Customer, você descobre que a consulta está lenta para ser executada. Você suspeita que a manutenção (maintenance) não foi realizada na tabela. Você precisa identificar se as tarefas de manutenção foram realizadas na tabela Customer. Solução: Você executa a seguinte instrução Spark SQL: DESCRIBE HISTORY customer. Isso atende ao objetivo?","options":["A. Sim ","B. Não "],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado Lakehouse1. O Lakehouse1 contém uma tabela Delta chamada Customer. Ao consultar a tabela Customer, você descobre que a consulta está lenta para ser executada. Você suspeita que a manutenção (maintenance) não foi realizada na tabela. Você precisa identificar se as tarefas de manutenção foram realizadas na tabela Customer. Solução: Você executa a seguinte instrução Spark SQL: REFRESH TABLE customer. Isso atende ao objetivo?","options":["A. Sim","B. Não "],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado Lakehouse1. O Lakehouse1 contém uma tabela Delta chamada Customer. Ao consultar a tabela Customer, você descobre que a consulta está lenta para ser executada. Você suspeita que a manutenção (maintenance) não foi realizada na tabela. Você precisa identificar se as tarefas de manutenção foram realizadas na tabela Customer. Solução: Você executa a seguinte instrução Spark SQL: EXPLAIN TABLE customer. Isso atende ao objetivo?","options":["A. Sim","B. Não "],"answer":[1]},
  {"q":"Você tem um repositório do Azure Repos chamado Repo1 e uma capacidade Microsoft Power BI Premium habilitada para o Fabric. A capacidade contém dois workspaces (áreas de trabalho) chamados Workspace1 e Workspace2. A integração com o Git está habilitada no nível do workspace. Você planeja usar o Microsoft Power BI Desktop e o Workspace1 para fazer alterações controladas por versão (version-controlled) em um modelo semântico armazenado no Repo1. As alterações serão compiladas e implantadas no Workspace2 usando o Azure Pipelines. Você precisa garantir que as definições do relatório e do modelo semântico sejam salvas como arquivos de texto individuais em uma hierarquia de pastas. A solução deve minimizar o esforço de desenvolvimento e manutenção. Em qual formato de arquivo você deve salvar as alterações?","options":["A. PBIP ","B. PBIDS","C. PBIT","D. PBIX"],"answer":[0]},
  {"q":"Você tem um workspace (área de trabalho) do Fabric chamado Workspace1 que contém um lakehouse chamado Lakehouse1. No Workspace1, você cria um pipeline de dados chamado Pipeline1. Você tem arquivos CSV armazenados em uma conta do Azure Storage. Você precisa adicionar uma atividade ao Pipeline1 que copiará os dados dos arquivos CSV para o Lakehouse1. A atividade deve suportar expressões da linguagem de fórmula M do Power Query. Que tipo de atividade você deve adicionar?","options":["A. Dataflow (Fluxo de dados) ","B. Notebook","C. Script","D. Copy data (Copiar dados)"],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse. Você planeja usar uma consulta visual (visual query) para mesclar (merge) duas tabelas. Você precisa garantir que a consulta retorne todas as linhas de ambas as tabelas. Qual tipo de junção (join) você deve usar?","options":["A. Inner (Interna)","B. Full outer (Externa completa) ","C. Left outer (Externa esquerda)","D. Right anti (Anti-direita)","E. Right outer (Externa direita)","F. Left anti (Anti-esquerda)"],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado Lakehouse1. O Lakehouse1 contém uma tabela Delta que possui um milhão de arquivos Parquet. Você precisa remover arquivos que NÃO foram referenciados pela tabela nos últimos 30 dias. A solução deve garantir que o log de transações permaneça consistente e que as propriedades ACID da tabela sejam mantidas. O que você deve fazer?","options":["A. No explorador de arquivos do OneLake, excluir os arquivos.","B. Executar OPTIMIZE Z-order.","C. Executar OPTIMIZE V-order.","D. Executar VACUUM. "],"answer":[3]},
  {"q":"Você tem um workspace (área de trabalho) do Fabric chamado Workspace1 e um banco de dados SQL do Azure. Você planeja criar um dataflow (fluxo de dados) que lerá dados do banco de dados e, em seguida, transformará os dados realizando um inner join (junção interna). Você precisa ignorar espaços (ignore spaces) nos valores ao realizar a junção interna. A solução deve minimizar o esforço de desenvolvimento. O que você deve fazer? ","options":["Anexar (Append) as consultas usando correspondência difusa (fuzzy matching). ","B. Mesclar (Merge) as consultas usando correspondência difusa (fuzzy matching). ","C. Anexar (Append) as consultas usando uma tabela de pesquisa (lookup table). ","D. Mesclar (Merge) as consultas usando uma tabela de pesquisa (lookup table)."],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um warehouse chamado Warehouse1. O Warehouse1 contém dois esquemas (schemas) chamados schema1 e schema2 e uma tabela chamada schema1.city. Você precisa fazer uma cópia de schema1.city no schema2. A solução deve minimizar a cópia de dados. Qual instrução T-SQL você deve executar?","options":["A. INSERT INTO schema2.city SELECT * FROM schema1.city;","B. SELECT * INTO schema2.city FROM schema1.city;","C. CREATE TABLE schema2.city AS CLONE OF schema1.city;","D. CREATE TABLE schema2.city AS SELECT * FROM schema1.city;"],"answer":[2]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado Lakehouse1. Você precisa impedir que novas tabelas adicionadas ao Lakehouse1 sejam adicionadas automaticamente ao modelo semântico padrão (default semantic model) do lakehouse. O que você deve configurar?","options":["A. as configurações do SQL analytics endpoint ","B. as configurações do modelo semântico","C. as configurações do workspace","D. as configurações do Lakehouse1"],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric. Você está criando um pipeline do Azure Data Factory. (Nota: O mesmo se aplica aos Pipelines do Fabric). Você tem uma stored procedure (procedimento armazenado) que retorna o número de clientes ativos e sua média de vendas para o mês atual. Você precisa adicionar uma atividade que executará a stored procedure em um warehouse. Os valores retornados devem estar disponíveis para as atividades subsequentes (downstream) do pipeline. Qual tipo de atividade você deve adicionar?","options":["A. Switch","B. Copy data","C. Append variable","D. Lookup "],"answer":[3]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém dois workspaces (áreas de trabalho) chamados Workspace1 e Workspace2. O Workspace1 contém um lakehouse chamado Lakehouse1. O Workspace2 contém um lakehouse chamado Lakehouse2. O Lakehouse1 contém uma tabela chamada dbo.Sales. O Lakehouse2 contém uma tabela chamada dbo.Customers. Você precisa garantir que pode escrever consultas SQL que referenciem tanto a dbo.Sales quanto a dbo.Customers na mesma consulta SQL, sem fazer cópias adicionais das tabelas. O que você deve usar?","options":["A. Atalho (Shortcut) ","B. Dataflow","C. View","D. Managed table"],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um warehouse. Você está projetando um modelo de esquema estrela (star schema) que conterá uma dimensão de cliente. A tabela de dimensão do cliente será uma dimensão de alteração lenta (SCD) Tipo 2. Você precisa recomendar quais colunas adicionar à tabela. As colunas NÃO devem existir na fonte de dados. Quais três tipos de colunas você deve recomendar? Cada resposta correta apresenta parte da solução. NOTA: Cada resposta correta vale um ponto.","options":["A. Foreign Key","B. Natural Key","C. Data/Hora Fim Vigência ","D. Surrogate Key ","E. Data/Hora Início Vigência "],"answer":[2,3,4]},
  {"q":"Você tem um tenant (locatário) do Fabric. Você planeja criar um pipeline de dados chamado Pipeline1. O Pipeline1 incluirá duas atividades que serão executadas em sequência. Você precisa garantir que uma falha da primeira atividade NÃO impeça (will NOT block) a segunda atividade de ser executada. Qual caminho condicional (conditional path) você deve configurar entre a primeira e a segunda atividade?","options":["A. Upon Failure","B. Upon Completion ","C. Upon Skip","D. Upon Success"],"answer":[1]},
  {"q":"Você tem um modelo semântico do Microsoft Power BI. Você precisa identificar quaisquer colunas de chave substituta (surrogate key) no modelo que tenham a propriedade \"Resumir por\" (Summarize By) definida com um valor diferente de \"Nenhum\" (None). A solução deve minimizar o esforço. O que você deve usar?","options":["A. DAX Formatter","B. Model explorer","C. Model view","D. Best Practice Analyzer (Tabular Editor) "],"answer":[3]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um modelo semântico. O modelo contém 15 tabelas. Você precisa alterar programaticamente cada coluna que termina com a palavra Key (Chave) para atender aos seguintes requisitos: Ocultar a coluna. Definir 'Anulável' (Nullable) como Falso (False). Definir 'Resumir por' (Summarize By) como 'Nenhum' (None). Definir 'Disponível em MDX' (Available in MDX) como Falso (False). Marcar a coluna como uma coluna-chave (key column).","options":["A. PB Desktop","B. ALM Toolkit","C. Tabular Editor ","D. DAX Studio"],"answer":[2]},
  {"q":"Você tem um relatório do Microsoft Power BI chamado Report1 que usa um modelo semântico do Fabric. Os usuários descobrem que o Report1 renderiza lentamente. Você abre o Analisador de Desempenho (Performance analyzer) e identifica que um visual chamado Orders By Date (Pedidos por Data) é o mais lento para renderizar. O detalhamento da duração do Orders By Date é mostrado na tabela a seguir: 'Other' = 1047ms, DAX = 27ms. O que fornecerá a maior redução na duração da renderização do Report1??","options":["A. Atualização auto página","B. Otimizar DAX","C. Alterar tipo visual","D. Reduzir número de visuais no relatório "],"answer":[3]},
  {"q":"Você tem um modelo semântico Direct Lake personalizado chamado Model1 que possui um bilhão de linhas de dados.  Você usa o Tabular Editor para se conectar ao Model1 usando o endpoint XMLA. Pergunta: Você precisa garantir que, quando os usuários interagirem com relatórios baseados no Model1, suas consultas sempre usem o modo Direct Lake. O que você deve fazer?","options":["A. Default Mode","B. Partitions Mode","C. Storage Location","D. Direct Lake Behavior "],"answer":[3]},
  {"q":"Você tem um modelo semântico do Microsoft Power BI que contém medidas. As medidas usam múltiplas funções CALCULATE e uma função FILTER. Você está avaliando o desempenho das medidas. Em qual caso de uso a substituição da função FILTER pela função KEEPFILTERS reduzirá o tempo de execução?","options":["A. CALCULATE aninhado","B. Referencia medida","C. Múltiplas tabelas","D. FILTER referencia coluna de tabela única (Import mode). "],"answer":[3]},
  {"q":"Você tem um modelo semântico chamado Model1. O Model1 contém cinco tabelas que usam o modo Importação (Import mode). O Model1 contém uma função de segurança em nível de linha (RLS) dinâmica chamada HR. A função HR filtra os dados dos funcionários para que os gerentes de RH (HR managers) vejam apenas os dados do departamento ao qual estão atribuídos. Você publica o Model1 em um tenant (locatário) do Fabric e configura a associação à função RLS. Você compartilha o modelo e os relatórios relacionados com os usuários. Um gerente de RH relata que os dados que ele vê em um relatório estão incompletos. O que você deve fazer para validar os dados vistos pelo gerente de RH?","options":["A. Test as role (dados)","B. Filtrar relatório","C. Test as role (ver relatório como usuário específico) ","D. Pedir para abrir no Desktop"],"answer":[2]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém arquivos JSON no OneLake. Os arquivos têm um bilhão (1.000.000.000) de itens. Você planeja realizar uma análise de série temporal (time series analysis) dos itens. Você precisa transformar os dados, visualizar os dados para encontrar insights, realizar detecção de anomalias e compartilhar os insights com outros usuários de negócios. A solução deve atender aos seguintes requisitos: Usar processamento paralelo (parallel processing). Minimizar a duplicação de dados. Minimizar o tempo de carregamento dos dados. O que você deve usar para transformar e visualizar os dados?","options":["A. PySpark em notebook ","B. Pandas em notebook","C. Power BI"],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém dados de churn (rotatividade) de clientes armazenados como arquivos Parquet no OneLake. Os dados contêm detalhes sobre a demografia dos clientes e o uso de produtos. Você cria um notebook do Fabric para ler os dados em um Spark DataFrame. Em seguida, você cria gráficos de colunas no notebook que mostram a distribuição de clientes retidos em comparação com clientes perdidos, com base na geografia, número de produtos comprados, idade e tempo como cliente (tenure). Que tipo de análise você está realizando?","options":["A. Diagnóstica","B. Descritiva ","C. Prescritiva","D. Preditiva"],"answer":[1]},
  {"q":"Você tem um workspace (área de trabalho) do Fabric chamado Workspace1 que contém um dataflow (fluxo de dados) chamado Dataflow1. O Dataflow1 retorna 500 linhas de dados. Você precisa identificar os valores mínimo (min) e máximo (max) para cada coluna nos resultados da consulta. Quais três opções da guia \"Exibir\" (Data view) você deve selecionar? Cada resposta correta apresenta parte da solução. NOTA: Cada resposta correta vale um ponto.","options":["A. Distribuição valores","B. Perfil de coluna ","C. Perfil no painel detalhes ","D. Qualidade coluna","E. Painel de detalhes "],"answer":[1,2,4]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um relatório do Microsoft Power BI. Você está explorando um novo modelo semântico. Você precisa exibir as seguintes estatísticas de coluna: Contagem (Count) Média (Average) Contagem de nulos (Null count) Contagem distinta (Distinct count) Desvio padrão (Standard deviation) Qual função do Power Query você deve executar?","options":["A. Table.schema","B. Table.view","C. Table.FuzzyGroup","D. Table.Profile "],"answer":[3]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado Lakehouse1. O Lakehouse1 contém uma tabela Delta chamada Customer. Ao consultar a tabela Customer, você descobre que a consulta está lenta para ser executada. Você suspeita que a manutenção (maintenance) não foi realizada na tabela. Pergunta: Você precisa identificar se as tarefas de manutenção foram realizadas na tabela Customer. Solução: Você executa a seguinte instrução Spark SQL: (DESCRIBE DETAIL customer) Isso atende ao objetivo?","options":["A. Sim","B. Não "],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um novo modelo semântico no OneLake. Você usa um notebook do Fabric para ler os dados em um Spark DataFrame. Você precisa avaliar os dados para calcular os valores mínimo (min), máximo (max), média (mean) e desvio padrão (standard deviation) para todas as colunas de string e numéricas. Solução: Você usa a seguinte expressão PySpark: df.explain().show() Isso atende ao objetivo?","options":["A. Sim","B. Não "],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um modelo semântico chamado Model1.  Você descobre que a seguinte consulta é executada lentamente no Model1. Você precisa reduzir o tempo de execução da consulta. Solução: Você substitui a linha 4 pelo seguinte código: ( RELATEDTABLE ('Order Item') ) atende?","options":["A. Sim","B. Não "],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um modelo semântico chamado Model1.  Você descobre que a seguinte consulta é executada lentamente no Model1. Você precisa reduzir o tempo de execução da consulta. Solução: Você substitui a linha 4 pelo seguinte código: NOT (ISEMPTY (CALCULATETABLE ('Order Item'))) atende?","options":["A. Sim ","B. Não"],"answer":[0]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um modelo semântico chamado Model1.  Você descobre que a seguinte consulta é executada lentamente no Model1. Você precisa reduzir o tempo de execução da consulta. Solução: Você substitui a linha 4 pelo seguinte código: CALCULATE (COUNTROWS ('Order Item')) > 0 atende?","options":["A. Sim","B. Não "],"answer":[1]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um lakehouse chamado LH1. Você cria novas tabelas no LH1. Você precisa garantir que as tabelas sejam adicionadas automaticamente ao modelo semântico padrão (default semantic model). O que você deve fazer?","options":["A. Desabilitar o 'Cache de Consulta' (Query Caching) para o modelo semântico padrão. ","B. No painel de configurações do LH1, habilitar 'Sincronizar o modelo semântico padrão do Power BI' (Sync the default Power BI semantic model). ","C. Habilitar a 'Atualização' (Refresh) para o modelo semântico padrão. ","D. Nas configurações de 'Endosso e descoberta' (Endorsement and discovery) do LH1, selecionar 'Tornar detectável' (Make discoverable)."],"answer":[1]},
  {"q":"Você tem um workspace (área de trabalho) do Microsoft Power BI Premium Per User (PPU) que contém um modelo semântico. Você tem um Serviço de Aplicativo do Azure (Azure App Service) chamado App1 que modifica a segurança em nível de linha (RLS) do modelo usando o endpoint XMLA. O App1 exige que os usuários façam login usando suas credenciais do Microsoft Entra para acessar o endpoint XMLA. Você precisa configurar o App1 para usar uma conta de serviço (service account) para acessar o modelo. O que você deve fazer primeiro?","options":["A. Adicionar uma identidade gerenciada (managed identity) ao workspace. ","B. Modificar a configuração do Endpoint XMLA. ","C. Fazer o upgrade do workspace para a capacidade Premium. ","D. Adicionar uma identidade gerenciada (managed identity) ao App1. "],"answer":[3]},
  {"q":"Você tem um tenant (locatário) do Fabric que contém um data warehouse. Você precisa carregar linhas em uma dimensão de alteração lenta (SCD) Tipo 2 grande. A solução deve minimizar o uso de recursos. Pergunta: Qual instrução T-SQL você deve usar?","options":["A. UPDATE E INSERT ","B. MERGE","C. TRUNCATE e INSERT","D. CREATE AS SELECT"],"answer":[0]},
  {"q":"Cenário: Sua rede contém um domínio on-premises do Active Directory Domain Services (AD DS) chamado contoso.com que sincroniza com um tenant (locatário) do Microsoft Entra usando o Microsoft Entra Connect. Você tem um tenant do Fabric que contém um modelo semântico.  Você habilita a segurança em nível de linha (RLS) dinâmica para o modelo e o implanta no serviço do Fabric.  Você consulta uma medida que inclui a função USERNAME(), e a consulta retorna um resultado em branco. Você precisa garantir que a medida retorne o nome principal do usuário (UPN) de um usuário. Solução: Você atualiza a medida para usar a função USEROBJECTID(). Isso atende ao objetivo?","options":["A. Sim","B. Não "],"answer":[1]},
  {"q":"Cenário: Sua rede contém um domínio on-premises do Active Directory Domain Services (AD DS) chamado contoso.com que sincroniza com um tenant (locatário) do Microsoft Entra usando o Microsoft Entra Connect. Você tem um tenant do Fabric que contém um modelo semântico.  Você habilita a segurança em nível de linha (RLS) dinâmica para o modelo e o implanta no serviço do Fabric.  Você consulta uma medida que inclui a função USERNAME(), e a consulta retorna um resultado em branco. Você precisa garantir que a medida retorne o nome principal do usuário (UPN) de um usuário. Solução: Você atualiza a medida para usar a função USERPRINCIPALNAME(). Isso atende ao objetivo?","options":["A. Sim ","B. Não"],"answer":[0]}
];
// ===== end data =====
</script>
  
document.addEventListener('DOMContentLoaded', () => {
  try {
    if(!Array.isArray(quizData) || quizData.length === 0) {
      showFatalError('Dados do quiz (quizData) não encontrados ou estão vazios. Verifique se o array de questões está presente no arquivo.');
      console.error('quizData inválido:', quizData);
      return;
    }
    initQuiz();
  } catch(err) {
    showFatalError('Erro ao inicializar o simulado. Abra o Console do navegador (F12) e veja o erro.');
    console.error('Erro init:', err);
  }
});

function showFatalError(msg) {
  const em = document.getElementById('error-msg');
  em.style.display = 'block';
  em.innerText = msg;
}

let current = 0;
let selections = {};
let score = 0;
let answered = {};

const qArea = document.getElementById('question-area');
const progress = document.getElementById('progress');
const btnPrev = document.getElementById('btn-prev');
const btnNext = document.getElementById('btn-next');
const btnCheck = document.getElementById('btn-check');
const resultBox = document.getElementById('result-box');

function initQuiz() {
  // attach events
  btnCheck.addEventListener('click', onCheck);
  btnNext.addEventListener('click', onNext);
  btnPrev.addEventListener('click', onPrev);
  // render first
  renderQuestion(0);
}

function renderQuestion(i){
  const data = quizData[i];
  if(!data) {
    qArea.innerHTML = '<div class="warn">Questão não encontrada.</div>';
    return;
  }
  qArea.innerHTML = `
    <div class="question-text"><strong>${i+1}.</strong> ${escapeHtml(data.q)}</div>
    <ul class="options" id="opts-${i}">
      ${data.options.map((o, idx)=>`<li class="option" data-idx="${idx}" onclick="toggleOption(${i},${idx},this)">${escapeHtml(o)}</li>`).join('')}
    </ul>
  `;
  const sel = selections[i] || [];
  sel.forEach(idx=>{
    const el = document.querySelector('#opts-'+i+' .option[data-idx="'+idx+'"]');
    if(el) el.classList.add('selected');
  });
  progress.innerText = `Questão ${i+1} de ${quizData.length}`;
  btnPrev.style.display = i===0 ? 'none' : 'inline-block';
  btnNext.style.display = 'none';
  btnCheck.style.display = 'inline-block';
  resultBox.style.display = 'none';
}

function toggleOption(qIdx, oIdx, el){
  try {
    el.classList.toggle('selected');
    selections[qIdx] = selections[qIdx] || [];
    if (selections[qIdx].includes(oIdx)){
      selections[qIdx] = selections[qIdx].filter(x=>x!==oIdx);
    } else {
      selections[qIdx].push(oIdx);
    }
  } catch(err) {
    console.error('toggleOption error', err);
  }
}
window.toggleOption = toggleOption;

function onCheck(){
  try {
    const data = quizData[current];
    const sel = (selections[current] || []).slice().sort((a,b)=>a-b);
    if(sel.length===0){ alert('Selecione uma ou mais opções antes de verificar.'); return; }
    const correct = (data.answer || []).slice().sort((a,b)=>a-b);
    const isCorrect = JSON.stringify(sel) === JSON.stringify(correct);
    const optsEls = document.querySelectorAll('#opts-'+current+' .option');
    optsEls.forEach((el, idx)=>{
      el.classList.remove('correct','wrong');
      if(correct.includes(idx)) el.classList.add('correct');
      if(sel.includes(idx) && !correct.includes(idx)) el.classList.add('wrong');
    });
    answered[current] = {selected: sel, correct: correct, ok: isCorrect};
    if(isCorrect) score++;
    resultBox.style.display = 'block';
    resultBox.innerHTML = isCorrect ? '<strong>Correto!</strong>' : '<strong>Incorreto.</strong> As respostas corretas estão marcadas.';
    btnCheck.style.display = 'none';
    btnNext.style.display = 'inline-block';
  } catch(err) {
    console.error('onCheck error', err);
    showFatalError('Erro ao verificar resposta. Veja o console (F12).');
  }
}

function onNext(){
  try {
    if(current < quizData.length - 1){
      current++;
      renderQuestion(current);
    } else {
      showFinal();
    }
  } catch(err) {
    console.error('onNext error', err);
  }
}

function onPrev(){
  try {
    if(current > 0){
      current--;
      renderQuestion(current);
    }
  } catch(err) {
    console.error('onPrev error', err);
  }
}

function showFinal(){
  let wrongs = Object.keys(answered).filter(k=>!answered[k].ok).map(k=>parseInt(k));
  for(let i=0;i<quizData.length;i++){
    if(!(i in answered)) wrongs.push(i);
  }
  wrongs = Array.from(new Set(wrongs)).sort((a,b)=>a-b);
  const total = quizData.length;
  const correctCount = score;
  let html = `<div class="final-card"><h2>Simulado Finalizado</h2><p>Você acertou <strong>${correctCount}</strong> de <strong>${total}</strong>.</p></div>`;
  if(wrongs.length>0){
    html += `<div class="err-list"><h3>Questões com erro ou não respondidas (${wrongs.length})</h3>`;
    wrongs.forEach(idx=>{
      const d = quizData[idx];
      const a = answered[idx] || {selected:[], correct:d.answer||[]};
      html += `<div style="margin-bottom:12px;padding:10px;border-radius:8px;background:#fff;border:1px solid #eee"><strong>Questão ${idx+1}</strong><div style="margin-top:6px">${escapeHtml(d.q)}</div><div style="margin-top:8px"><em>Sua resposta:</em> ${formatOptions(d.options,a.selected)}</div><div style="margin-top:4px"><em>Resposta correta:</em> ${formatOptions(d.options,a.correct)}</div></div>`;
    });
    html += `</div>`;
  } else {
    html += `<p>Parabéns! Todas as questões foram respondidas corretamente.</p>`;
  }
  qArea.innerHTML = html;
  progress.innerText = 'Concluído';
  try { document.querySelector('.controls').style.display = 'none'; } catch(e){}
  resultBox.style.display = 'none';
  window.scrollTo({top:0,behavior:'smooth'});
}

function formatOptions(options, indices){
  if(!indices || indices.length===0) return '<span class="small">(Nenhuma)</span>';
  return indices.map(i=>`<strong>${options[i]}</strong>`).join(', ');
}

function escapeHtml(s){ return String(s).replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]; }); }
</script>
</body>
</html>
